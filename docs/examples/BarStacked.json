{"main":{"title":"main.js","contents":"import { default as LayerCake, flatten } from 'layercake';\nimport { stack } from 'd3-shape';\nimport { scaleBand } from 'd3-scale';\nimport fruit from './data/fruitOrdinal.js';\nimport BarStacked from './components/BarStacked.html';\nimport AxisX from './components/AxisX.html';\nimport AxisY from './components/AxisYScaleBand.html';\n\nconst seriesNames = Object.keys(fruit[0]).filter(d => d !== 'year');\n\nconst stackData = stack()\n  .keys(seriesNames);\n\nconst series = stackData(fruit);\n\nfunction formatXTick (d) {\n  if (d > 999) {\n    return Math.round(d / 1000) + 'k';\n  }\n  return d;\n}\n\nconst colors = ['#00bbff', '#8bcef6', '#c4e2ed', '#f7f6e3'];\n\nconst myCake = new LayerCake({\n  padding: { top: 0, right: 0, bottom: 20, left: 30 },\n  y: d => d.data.year,\n  x: [0, 1],\n  yScale: scaleBand().paddingInner([0.05]).round(true),\n  yDomain: ['2016', '2017', '2018', '2019'],\n  flatData: flatten(series),\n  data: series,\n  target: document.getElementById('my-chart'),\n  custom: { seriesNames }\n})\n  .svgLayers([\n    { component: AxisX, opts: { formatTick: formatXTick, baseline: true, snapTicks: true } },\n    { component: AxisY, opts: { gridlines: false } },\n    { component: BarStacked, opts: { colors } }\n  ]);\n\nmyCake.render();"},"components":[{"title":"./components/BarStacked.html","contents":"{#each $data as series}\n  {#each series as d}\n    <rect class='group-rect' data-id=\"{i}\" x=\"{x(d)[0]}\" y=\"{y(d)}\" {height} width=\"{width(d)}\"fill={fill(series.key)}></rect>\n  {/each}\n  }\n{/each}\n\n<script>\nimport { scaleOrdinal } from 'd3-scale';\n\nexport default {\n  namespace: 'svg',\n  computed: {\n    colorScale: ({ $xScale, $custom, $data, opts }) => {\n      return scaleOrdinal()\n        .domain($custom.seriesNames)\n        .range(opts.colors);\n    },\n    fill: ({ colorScale, $custom }) => {\n      return seriesName => colorScale(seriesName);\n    },\n    x: ({ $xGet }) => {\n      return (d) => {\n        return $xGet(d);\n      };\n    },\n    y: ({ $yGet }) => {\n      return (d) => {\n        return $yGet(d);\n      };\n    },\n    height: ({ $yScale }) => {\n      return $yScale.bandwidth();\n    },\n    width: ({ x }) => {\n      return (d) => {\n        const vals = x(d);\n        return vals[1] - vals[0];\n      };\n    }\n  }\n};\n</script>"},{"title":"./components/AxisX.html","contents":"<g class='axis x-axis'>\n  {#each ticks as tick, i}\n    <g class='tick tick-{ tick }' transform='translate({$xScale(tick)},{$yScale.range()[0]})'>\n      {#if opts.gridlines !== false}\n        <line y1='{$height * -1}' y2='0' x1='0' x2='0'></line>\n      {/if}\n      <text y='16' text-anchor='{textAnchor(i)}'>{opts.formatTick ? opts.formatTick(tick) : tick}</text>\n    </g>\n  {/each}\n  {#if opts.baseline === true}\n    <line class=\"baseline\" y1='{$height - 0.5}' y2='{$height - 0.5}' x1='0' x2='{$width}'></line>\n  {/if}\n</g>\n\n<style>\n  .tick {\n    font-size: .725em;\n    font-weight: 200;\n  }\n\n  line,\n  .tick line {\n    stroke: #aaa;\n    stroke-dasharray: 2;\n  }\n\n  .tick text {\n    fill: #666;\n  }\n\n  .baseline {\n    stroke-dasharray: 0;\n  }\n</style>\n\n<script>\nexport default {\n  namespace: 'svg',\n  computed: {\n    ticks: ({ $xScale, opts }) => {\n      return $xScale.ticks(opts.tickNumber);\n    },\n    textAnchor: ({ ticks, opts }) => {\n      return function (i) {\n        if (opts.snapTicks === true) {\n          if (i === 0) {\n            return 'start';\n          }\n          if (i === ticks.length -1) {\n            return 'end';\n          }\n        }\n        return 'middle';\n      };\n    }\n  }\n};\n</script>"},{"title":"./components/AxisYScaleBand.html","contents":"<g class='axis y-axis'>\n  {#each $yScale.domain() as tick}\n    <g class='tick tick-{ tick }' transform='translate({$xScale.range()[0]}, {$yScale(tick)})'>\n      {#if opts.gridlines !== false}\n        <line y1='{$width * -1}' y2='0' x1='0' x2='0'></line>\n      {/if}\n      <text y='{4 + ($yScale.bandwidth() / 2)}' x=\"-5\">{opts.formatTick ? opts.formatTick(tick) : tick}</text>\n    </g>\n  {/each}\n</g>\n\n<style>\n  .tick {\n    font-size: .725em;\n    font-weight: 200;\n  }\n\n  .tick line {\n    stroke: #aaa;\n    stroke-dasharray: 2;\n  }\n\n  .tick text {\n    fill: #666;\n  }\n\n  .tick.tick-0 line {\n    stroke-dasharray: 0;\n  }\n\n  .y-axis .tick text {\n    text-anchor: end;\n  }\n</style>\n\n<script>\nexport default {\n  namespace: 'svg'\n};\n</script>"}],"modules":[{"title":"./data/fruitOrdinal.js","contents":"/* --------------------------------------------\n *\n * Example data for stacked charts\n * from D3 documentation\n * Adapted from https://github.com/d3/d3-shape/blob/master/README.md#stack\n *\n * --------------------------------------------\n */\nexport default [\n  {year: '2019', apples: 3840, bananas: 1920, cherries: 960, dates: 400},\n  {year: '2018', apples: 1600, bananas: 1440, cherries: 960, dates: 400},\n  {year: '2017', apples: 820, bananas: 1000, cherries: 640, dates: 400},\n  {year: '2016', apples: 820, bananas: 560, cherries: 720, dates: 400}\n];"}],"componentModules":[],"dek":""}